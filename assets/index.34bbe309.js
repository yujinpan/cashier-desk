var w=Object.defineProperty;var $=(s,t,e)=>t in s?w(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var l=(s,t,e)=>($(s,typeof t!="symbol"?t+"":t,e),e);import{P,C as p,V as d,n as _,s as D}from"./index.85bb56ed.js";import{g as F}from"./menu.5afae388.js";import{o as v,a as M}from"./order.6a96adb2.js";import{D as O}from"./dictionary.fbd0cb7a.js";const S={inserted(s,t){const e=()=>{A(s,t.value)};s.addEventListener("click",e),s._move_to_destroy=()=>{s.removeEventListener("click",e)}},unbind(s){var t;(t=s._move_to_destroy)==null||t.call(s),s._move_to_destroy=null}};async function A(s,t){const e=B(s);document.body.append(e),await m(e,()=>{const{x:a,y:n}=T(e,t);f(e,{transform:`translate(${n}px,${a}px)`,opacity:.8,duration:1})}),await m(e,()=>{f(e,{transform:"scale(0)",opacity:0,duration:.45})}),e.remove()}function B(s){const t=s.cloneNode(!0),e=h(s);return t.style.width=e.width+"px",t.style.height=e.height+"px",t.style.top=e.top+"px",t.style.left=e.left+"px",t.style.position="absolute",t.style.zIndex="1000",t.style.boxShadow="0 0 10px 3px white",t}function h(s){const t=s.getBoundingClientRect(),{scrollLeft:e,scrollTop:a}=document.scrollingElement;return{width:t.width,height:t.height,top:a+t.top,left:e+t.left}}function T(s,t){const{width:e,height:a,top:n,left:o}=h(s),[r,b]=[n+a/2,o+e/2],[C,g]=t;return{x:C-r,y:g-b}}function f(s,t){s.style.transition=`all ${t.duration}s`,s.style.opacity=String(t.opacity),s.style.transform=s.style.transform.split(" ").concat(t.transform).join(" ")}function m(s,t){return new Promise(e=>{t(),setTimeout(()=>{E(s).finally(e)})})}function E(s){return new Promise(t=>{const e=()=>{t(),s.removeEventListener("transitionend",e)};s.addEventListener("transitionend",e)})}var j=Object.defineProperty,z=Object.getOwnPropertyDescriptor,y=(s,t,e,a)=>{for(var n=a>1?void 0:a?z(t,e):t,o=s.length-1,r;o>=0;o--)(r=s[o])&&(n=(a?r(t,e,n):r(n))||n);return a&&n&&j(t,e,n),n};let i=class extends d{constructor(){super(...arguments);l(this,"value")}};y([P()],i.prototype,"value",2);i=y([p],i);var L=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"cm-flex-wrap cm-flex-center"},[t._v(" \u603B\u91D1\u989D\uFF1A "),e("span",{staticClass:"cm-color-primary",staticStyle:{"font-size":"50px"}},[t._v(t._s(t.value))]),t._v(" \xA0\xA0\u5143 ")])},R=[],G=_(i,L,R,!1,null,null,null,null);const x=G.exports;var I=Object.defineProperty,N=Object.getOwnPropertyDescriptor,V=(s,t,e,a)=>{for(var n=a>1?void 0:a?N(t,e):t,o=s.length-1,r;o>=0;o--)(r=s[o])&&(n=(a?r(t,e,n):r(n))||n);return a&&n&&I(t,e,n),n};let c=class extends d{constructor(){super(...arguments);l(this,"visible",!1);l(this,"data",[]);l(this,"columns",[{prop:"name",label:"\u540D\u79F0"},{prop:"count",label:"\u6570\u91CF",width:"170px"},{prop:"price",label:"\u5355\u4EF7(\u5143)"},{prop:"total",label:"\u603B\u4EF7(\u5143)",formatter:(t,e)=>e.price*e.count}])}get total(){return v(this.data)}open(t){this.visible=!0,this.data=[...t]}submit(){return M(this.data).then(()=>{D("\u64CD\u4F5C\u6210\u529F","success"),this.$emit("submit"),this.close()})}close(){this.$emit("close"),this.visible=!1}};c=V([p({components:{Total:x}})],c);var X=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("el-dialog",{attrs:{visible:t.visible,title:"\u8BA2\u5355\u786E\u8BA4",width:"750px","append-to-body":"","close-on-click-modal":!1,"show-close":!1},scopedSlots:t._u([{key:"footer",fn:function(){return[e("div",{staticClass:"cm-text-center settle-footer"},[e("CMButton",{attrs:{type:"primary"},on:{click:function(a){return t.submit()}}},[t._v("\u5B8C\u6210\u4E0B\u5355")]),e("CMButton",{on:{click:function(a){return t.close()}}},[t._v("\u53D6\u6D88")])],1)]},proxy:!0}])},[e("div",{staticClass:"settle"},[e("CMTable",{ref:"CMTable",staticClass:"order-list cm-flex-auto__content",attrs:{columns:t.columns,data:t.data,border:!1,order:!1,"show-overflow-tooltip":!1,"max-height":"320px",size:"large"}}),e("Total",{staticClass:"cm-margin-top-large",attrs:{value:t.total}})],1)])},Y=[],W=_(c,X,Y,!1,null,"502083db",null,null);const q=W.exports;var H=Object.defineProperty,J=Object.getOwnPropertyDescriptor,K=(s,t,e,a)=>{for(var n=a>1?void 0:a?J(t,e):t,o=s.length-1,r;o>=0;o--)(r=s[o])&&(n=(a?r(t,e,n):r(n))||n);return a&&n&&H(t,e,n),n};let u=class extends d{constructor(){super(...arguments);l(this,"menus",[]);l(this,"data",[]);l(this,"columns",[{prop:"name",label:"\u540D\u79F0"},{prop:"count",label:"\u6570\u91CF",width:"170px",type:"form-control",formControlProps:{type:"input_number"}},{label:"\u5220\u9664",type:"handle",width:"80px",handleButtons:[{icon:"el-icon-delete",type:"danger",handler:t=>{this.delete(t)}}]}]);l(this,"typeMap",O.getMapSync("menu_type"))}get menuGroup(){return this.menus.reduce((t,e)=>{const a=t.find(n=>n.type===e.type);return a?(a.data.push(e),t):t.concat([{type:e.type,data:[e]}])},[])}get total(){return v(this.data)}delete(t){const e=this.data.indexOf(t);this.data.splice(e,1)}add(t){const e=this.data.find(a=>a.id===t.id);e?e.count++:this.data.push({...t,count:1})}submit(){!this.data.length||this.$refs.Settle.open(this.data)}reset(){this.data=[]}update(){F().then(t=>{this.menus=t})}activated(){this.update()}mounted(){this.update()}};u=K([p({components:{Total:x,Settle:q},directives:{MoveTo:S}})],u);var Q=function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",{staticClass:"dashboard cm-flex-auto"},[e("div",{staticClass:"order cm-flex-auto__fixed cm-flex-auto cm-flex-column",staticStyle:{width:"400px"}},[e("CMTable",{ref:"CMTable",staticClass:"order-list cm-flex-auto__content",attrs:{columns:t.columns,data:t.data,border:!1,order:!1,"show-overflow-tooltip":!1,"empty-text":"\u8D2D\u7269\u8F66\u4E3A\u7A7A",height:"100%"}}),e("div",{staticClass:"order-submit cm-flex-auto__fixed cm-flex-space-between"},[e("CMButton",{attrs:{type:"success"},on:{click:t.submit}},[t._v("\u4E0B\u5355")]),e("Settle",{ref:"Settle",on:{submit:function(a){return t.reset()}}}),e("Total",{attrs:{value:t.total}})],1)],1),e("div",{staticClass:"menu cm-flex-auto__content cm-scroll-y"},t._l(t.menuGroup,function(a){return e("div",{key:a.type},[e("CMLabel",{staticClass:"cm-margin-bottom-base",attrs:{label:t.typeMap[a.type],"label-size":"26px",title:""}}),e("ul",{staticClass:"menu__list cm-flex-wrap cm-list-unstyled"},t._l(a.data,function(n){return e("li",{key:n.id,staticClass:"menu__list-item"},[e("CMButton",{directives:[{name:"move-to",rawName:"v-move-to",value:[300,330],expression:"[300, 330]"}],staticStyle:{"line-height":"35px"},attrs:{column:"",type:n.type==="meat"?"primary":"success"},on:{click:function(o){return t.add(n)}}},[e("span",{staticClass:"cm-text-ellipsis-2",staticStyle:{"font-size":"30px","white-space":"normal"}},[t._v(" "+t._s(n.name)+" ")]),e("span",{staticStyle:{"font-size":"16px"}},[t._v("\xA5\xA0")]),e("span",[t._v(t._s(n.price))])])],1)}),0)],1)}),0)])},U=[],Z=_(u,Q,U,!1,null,"58fcac6e",null,null);const at=Z.exports;export{at as default};
